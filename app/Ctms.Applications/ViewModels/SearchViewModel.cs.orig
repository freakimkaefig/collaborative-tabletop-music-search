using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel.Composition;
using System.Waf.Applications;
using System.Windows.Input;
using Ctms.Applications.Views;
using Ctms.Domain.Objects;
using Microsoft.Surface.Presentation.Controls;
using System.Collections.ObjectModel;
<<<<<<< HEAD
using MusicSearch.SearchObjects;
using MusicSearch.Managers;
=======
using Ctms.Applications.DataModels;
using System.Threading;
using System.Windows.Data;
using Ctms.Domain;
>>>>>>> origin/dev

namespace Ctms.Applications.ViewModels
{
    [Export]
    public class SearchViewModel : ViewModel<ISearchView>
    {
        private bool        _isValid = true;
        private string      _keywordType;
        private ICommand    _startSearchCommand;
        private ICommand    _selectOptionCmd;
        private ICommand    _getSuggestionsCmd;
        private string      _item1Header;
        private string      _item2Header;
        private int         _mainItemId;
        private List<TagVisualization> _tagVisualizations;
<<<<<<< HEAD

        private List<searchObjects> _searchObjectsList; //Liste an SearchObjects (Michl, die musst du dann befüllen!)
        
=======
        private ISearchView _searchView;
        private Keyword _assignedKeyword;
        private ObservableCollection<TagDataModel> _tags;
        private ICommand _goHomeCmd;
        private ICommand    _goBreadcrumbCmd;
        private bool        _addedVisualization;
        private ICommand _addVisualizationCmd;
        private ICommand _editCmd;
>>>>>>> origin/dev
        //private readonly IEnumerable<SearchTagViewModel> _searchTags;

        [ImportingConstructor]
        public SearchViewModel(ISearchView view)
            : base(view)
        {
<<<<<<< HEAD
            tagOptions = new ObservableCollection<TagOption>();
            TagVisualizations = new List<TagVisualization>();

            _entries = new List<Entry>()
            {
                new Entry { Id = 0, Header = "Hypocratics", SubHeader = "Audioslave" },
                new Entry { Id = 1, Header = "Hypocratics", SubHeader = "Katy Perry" },
                new Entry { Id = 2, Header = "Hypocratics", SubHeader = "Anyone" },
                new Entry { Id = 3, Header = "Hypocratics", SubHeader = "John Wayne" },
                new Entry { Id = 4, Header = "Hypocratics", SubHeader = "Justin Bieber" }
            };

            //Testweise hinzufügen eines SearchObjects
                //MICHL: befüllen durch Tangibles die auf dem Tisch stehen!
                //       Einträge auch wieder löschen, wenn Tangible vom Tisch genommen wird (über originId)
            _searchObjectsList = new List<searchObjects>();
            _searchObjectsList.Add(new searchObjects
            {
                genre = "rock",
                originId = 1

            });
        }

        public List<searchObjects> SearchObjectsList
        {
            get { return _searchObjectsList; }
            set
            {
                if (_searchObjectsList != value)
                {
                    _searchObjectsList = value;
                    RaisePropertyChanged("SearchObjectsList");
                }
            }
=======
            _tags = new ObservableCollection<TagDataModel>();
            _searchView = view;
>>>>>>> origin/dev
        }

        public SearchViewModel() : base(null)
        {

        }

        #region Properties

        public bool IsEnabled { get { return true; } }

        public bool IsValid
        {
            get { return _isValid; }
            set
            {
                if (_isValid != value)
                {
                    _isValid = value;
                    RaisePropertyChanged("IsValid");
                }
            }
        }

        public string KeywordType
        {
            get { return _keywordType; }
            set
            {
                if (_keywordType != value)
                {
                    _keywordType = value;
                    RaisePropertyChanged("KeywordType");
                }
            }
        }

        public Keyword AssignedKeyword
        {
            get { return _assignedKeyword; }
            set
            {
                if (_assignedKeyword != value)
                {
                    _assignedKeyword = value;
                    RaisePropertyChanged("AssignedKeyword");
                }
            }
        }

        public ObservableCollection<TagDataModel> Tags
        {
            get { return _tags; }
            set
            {
                if (_tags != value)
                {
                    _tags = value;
                    RaisePropertyChanged("Tags");
                }
            }
        }

        public bool AddedVisualization
        {
            get { return _addedVisualization; }
            set
            {
                if (_addedVisualization != value)
                {
                    _addedVisualization = value;
                    RaisePropertyChanged("AddedVisualization");
                }
            }
        }



        #endregion


        #region Commands

        public ICommand StartSearchCmd
        {
            get { return _startSearchCommand; }
            set
            {
                if (_startSearchCommand != value)
                {
                    _startSearchCommand = value;
                    RaisePropertyChanged("StartSearchCmd");
                }
            }
        }

        public ICommand SelectOptionCmd
        {
            get { return _selectOptionCmd; }
            set
            {
                if (_selectOptionCmd != value)
                {
                    _selectOptionCmd = value;

                    RaisePropertyChanged("SelectOptionCmd");
                }
            }
        }

        public ICommand GoHomeCmd
        {
            get { return _goHomeCmd; }
            set
            {
                if (_goHomeCmd != value)
                {
                    _goHomeCmd = value;

                    RaisePropertyChanged("GoHomeCmd");
                }
            }
        }

        public ICommand GoBreadcrumbCmd
        {
            get { return _goBreadcrumbCmd; }
            set
            {
                if (_goBreadcrumbCmd != value)
                {
                    _goBreadcrumbCmd = value;

                    RaisePropertyChanged("GoBreadcrumbCmd");
                }
            }
        }
        

        public ICommand GetSuggestionsCmd
        {
            get { return _getSuggestionsCmd; }
            set
            {
                if (_getSuggestionsCmd != value)
                {
                    _getSuggestionsCmd = value;
                    RaisePropertyChanged("GetSuggestionsCmd");
                }
            }
        }

        public ICommand EditCmd
        {
            get { return _editCmd; }
            set
            {
                if (_editCmd != value)
                {
                    _editCmd = value;
                    RaisePropertyChanged("EditCmd");
                }
            }
        }

        #endregion Commands  

        public void OnVisualizationAdded(int tagId)
        {
            AddVisualization.Execute(tagId);
        }

        public ICommand AddVisualization
        {
            get { return _addVisualizationCmd; }
            set
            {
                if (_addVisualizationCmd != value)
                {
                    _addVisualizationCmd = value;
                    RaisePropertyChanged("AddVisualization");
                }
            }
        }

        public void UpdateVisuals(TagDataModel tagDM)
        {
            _searchView.UpdateVisual(tagDM.Id);
        }
    }
}
